import"./el-input.Jahd1Hjo.js";import{v as e}from"./el-loading.BpbtoYT8.js";import{E as a}from"./el-progress.5mVu7H9Z.js";import{_ as t}from"./index.7W5TP-Gr.js";import{E as o}from"./el-dialog.BAn0Jijl.js";import{a as l,s as i}from"./index.BEJnBAIn.js";import{u as s,z as r,E as n,a as p}from"./zh-cn.CmAru0Nm.js";/* empty css               */import"./el-select.Ds80L7A8.js";import"./el-popper.ByQXy_St.js";import{E as d,a as m}from"./el-table-column.DtRtph-D.js";import"./el-tooltip.l0sNRNKZ.js";import{E as u}from"./el-card.C6FIB03H.js";import{a as c,g,p as f,h}from"./index.Dl9EuN7S.js";import{d as j,y as v,o as _,r as w,k as C,f as k,m as b,w as y,u as x,Y as z,F as E,a as V,A as B,e as A,b as U,B as $,C as O,_ as S}from"./index.vLuz2ctl.js";import{E as T}from"./index.CvHxpMx1.js";import{E as I}from"./index.B8LY5wXu.js";import{E as L}from"./index.CDVZeGTi.js";import"./use-form-item.DGQHv2C0.js";import"./_baseClone.Byh6-Sp3.js";import"./_Uint8Array.DGEuPrOq.js";import"./_initCloneObject.D7LM1uMc.js";import"./isEqual.DYDatXy1.js";import"./use-dialog.B4w-7Ecf.js";import"./vnode.BuYHpAJn.js";import"./scroll.CNU-wLPw.js";import"./focus-trap.BSN58JPK.js";import"./refs.C8C70A12.js";import"./index.gz-8guSF.js";import"./castArray.DmlTlyrk.js";import"./aria.C-hsWcn7.js";const q=e=>($("data-v-607ed9a5"),e=e(),O(),e),D={class:"am-image-title"},F={class:"am-image-operator"},K={class:"am-table"},P={class:"am-pagination"},J={class:"am-image-pull"},M={class:"am-image-import"},N=q((()=>k("div",{class:"el-upload__text"},[B("Drop file here or "),k("em",null,"click to upload")],-1))),Y=q((()=>k("div",{class:"el-upload__tip"},"tar/tar.gz files",-1))),G=S(j({__name:"index",setup(j){const $=v();_((()=>{q()}));const O=w(0),{data:S,refresh:q,loading:G,pagination:H}=s(c,{},{}),Q=()=>{f().then((()=>{l({type:"success",message:"清理完成"})}))},R=w(!1),W=w(!1),X=w(""),Z=async()=>{R.value=!0;let e={image_name:X.value};const{data:a}=await h(e);R.value=!1,W.value=!1,q()},ee=w(!1),ae=()=>{i("导入成功"),ee.value=!1,q()};return(i,s)=>{const c=I,f=u,h=d,j=m,v=n,_=p,w=L,te=o,oe=t,le=a,ie=e;return V(),C(E,null,[k("div",D,[k("span",{onClick:s[0]||(s[0]=e=>i.$router.push("/docker/container"))},"容器"),k("span",{onClick:s[1]||(s[1]=e=>i.$router.push("/docker/image"))},"镜像"),k("span",{onClick:s[2]||(s[2]=e=>i.$router.push("/docker/network"))},"网络"),k("span",{onClick:s[3]||(s[3]=e=>i.$router.push("/docker/settings"))},"设置")]),k("div",F,[b(f,{shadow:"never"},{default:y((()=>[b(c,{type:"primary",plain:"",onClick:s[4]||(s[4]=e=>W.value=!0)},{default:y((()=>[B("拉取镜像")])),_:1}),b(c,{type:"primary",plain:"",onClick:s[5]||(s[5]=e=>ee.value=!0)},{default:y((()=>[B("导入镜像")])),_:1}),b(c,{type:"warning",plain:"",onClick:Q},{default:y((()=>[B("清理虚悬镜像")])),_:1})])),_:1})]),b(f,{shadow:"never"},{default:y((()=>[k("div",K,[A((V(),U(j,{data:x(S),key:x(O),"highlight-current-row":"",height:"100%",stripe:""},{default:y((()=>[b(h,{prop:"id",label:"镜像 ID",align:"center",width:"120",fixed:"",sortable:""}),b(h,{prop:"name",label:"镜像名称",align:"center","min-width":"150","show-overflow-tooltip":"",fixed:"",sortable:""}),b(h,{prop:"number",label:"容器数量",align:"center","show-overflow-tooltip":"",width:"120",sortable:""}),b(h,{prop:"tag",label:"镜像 Tag",align:"center","show-overflow-tooltip":"",width:"120"}),b(h,{prop:"created",label:"创建时间",align:"center",width:"200",sortable:""}),b(h,{prop:"size",label:"镜像大小",align:"center",width:"120",sortable:""}),b(h,{label:"操作",width:"160",fixed:"right",align:"center"},{default:y((e=>[b(c,{type:"danger",plain:"",size:"small",onClick:a=>{return t=e.row.id,T.confirm("该操作会删除该镜像. 继续吗?","警告",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",beforeClose:(e,a,o)=>{"confirm"===e?(a.confirmButtonLoading=!0,g({image_id:t}).then((()=>{l({type:"success",message:"删除完成"})})).finally((()=>{a.confirmButtonLoading=!1,o(),q(),O.value+=1}))):o()}}).then((()=>{})).catch((()=>{l({type:"info",message:"删除取消"})})),void q();var t}},{default:y((()=>[B(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ie,x(G)]])]),k("div",P,[b(_,{locale:x(r)},{default:y((()=>[b(v,{"current-page":x(H).page,"onUpdate:currentPage":s[6]||(s[6]=e=>x(H).page=e),"page-size":x(H).size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":x(H).sizeOption,total:x(H).total,onSizeChange:x(H).onSizeChange,onCurrentChange:x(H).onPageChange},null,8,["current-page","page-size","page-sizes","total","onSizeChange","onCurrentChange"])])),_:1},8,["locale"])])])),_:1}),k("div",J,[b(te,{modelValue:x(W),"onUpdate:modelValue":s[8]||(s[8]=e=>z(W)?W.value=e:null),title:"拉取镜像",width:"50%"},{default:y((()=>[b(w,{modelValue:x(X),"onUpdate:modelValue":s[7]||(s[7]=e=>z(X)?X.value=e:null),placeholder:"请输入镜像名称"},null,8,["modelValue"]),A((V(),U(c,{size:"default",type:"info",plain:"",onClick:Z},{default:y((()=>[B(" 确定 ")])),_:1})),[[ie,x(R)]])])),_:1},8,["modelValue"])]),k("div",M,[b(te,{modelValue:x(ee),"onUpdate:modelValue":s[9]||(s[9]=e=>z(ee)?ee.value=e:null),title:"导入镜像",width:"50%"},{default:y((()=>[b(le,{drag:"",action:"/app/api/v1/container/image_import",headers:{Authorization:`Bearer ${x($).user.token}`},limit:1,multiple:"","on-success":ae},{tip:y((()=>[Y])),default:y((()=>[b(oe,{"icon-class":"upload"}),N])),_:1},8,["headers"])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-607ed9a5"]]);export{G as default};
