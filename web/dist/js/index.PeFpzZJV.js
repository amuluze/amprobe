import"./el-button.BK6voByF.js";import{v as e}from"./el-loading.BFRyc6sK.js";import{E as a}from"./el-progress.B6RnwLLt.js";import{_ as t}from"./index.1aLyGvSL.js";import{E as o}from"./el-dialog.CWM_2Q-H.js";import{a as l,s as i}from"./message.C0_S-oRD.js";import{u as s,z as r,E as n,a as p}from"./zh-cn.CSrCeJhK.js";/* empty css               */import"./el-select.BKEWdrCh.js";import"./el-popper.rDHzJdfY.js";import{E as m,a as d}from"./el-table-column.BxN4qArM.js";import"./el-tooltip.l0sNRNKZ.js";import{E as u}from"./el-card.Cu2xDQEz.js";import{a as c,g,p as f,h}from"./index.Bg7taOKw.js";import{d as j,y as v,o as _,r as w,k as C,f as k,m as y,w as b,u as x,X as z,F as E,a as V,A as B,e as U,b as $,R as A,S,_ as L}from"./index.CcWlFavh.js";import{E as O}from"./index.CUVTym-u.js";import{E as P}from"./index.Wz42SFXV.js";import{E as T}from"./index.Br76DJIc.js";import"./index.o7Bhr1PB.js";import"./_baseClone.C08sNJS2.js";import"./_Uint8Array.BEr-xkIt.js";import"./_initCloneObject.C9_4sulU.js";import"./isEqual.BzE1k7sS.js";import"./use-dialog.BzA524NB.js";import"./vnode.BYTgskXD.js";import"./event.BwRzfsZt.js";import"./use-form-item.DLVuMIRh.js";import"./scroll.DLH_9jLr.js";import"./focus-trap.CFBBOCaf.js";import"./refs.F2B_LDe0.js";import"./index.CCwm-fST.js";import"./token.DWNpOE8r.js";import"./castArray.Ct41h88a.js";import"./index.DZ_LmjtP.js";import"./aria.C-hsWcn7.js";import"./validator.d58ifklI.js";const D=e=>(A("data-v-d67fd53e"),e=e(),S(),e),K={class:"am-image-title"},R={class:"am-image-operator"},X={class:"am-table"},q={class:"am-pagination"},F={class:"am-image-pull"},G={class:"am-image-import"},H=D((()=>k("div",{class:"el-upload__text"},[B("Drop file here or "),k("em",null,"click to upload")],-1))),I=D((()=>k("div",{class:"el-upload__tip"},"tar/tar.gz files",-1))),J=L(j({__name:"index",setup(j){const A=v();_((()=>{D()}));const S=w(0),{data:L,refresh:D,loading:J,pagination:N}=s(c,{},{}),W=()=>{f().then((()=>{l({type:"success",message:"清理完成"})}))},Y=w(!1),Z=w(!1),M=w(""),Q=async()=>{Y.value=!0;let e={image_name:M.value};const{data:a}=await h(e);Y.value=!1,Z.value=!1,D()},ee=w(!1),ae=()=>{i("导入成功"),ee.value=!1,D()};return(i,s)=>{const c=P,f=u,h=m,j=d,v=n,_=p,w=T,te=o,oe=t,le=a,ie=e;return V(),C(E,null,[k("div",K,[k("span",{onClick:s[0]||(s[0]=e=>i.$router.push("/docker/container"))},"容器"),k("span",{onClick:s[1]||(s[1]=e=>i.$router.push("/docker/image"))},"镜像"),k("span",{onClick:s[2]||(s[2]=e=>i.$router.push("/docker/network"))},"网络"),k("span",{onClick:s[3]||(s[3]=e=>i.$router.push("/docker/settings"))},"设置")]),k("div",R,[y(f,{shadow:"never"},{default:b((()=>[y(c,{type:"primary",plain:"",onClick:s[4]||(s[4]=e=>Z.value=!0)},{default:b((()=>[B("拉取镜像")])),_:1}),y(c,{type:"primary",plain:"",onClick:s[5]||(s[5]=e=>ee.value=!0)},{default:b((()=>[B("导入镜像")])),_:1}),y(c,{type:"warning",plain:"",onClick:W},{default:b((()=>[B("清理虚悬镜像")])),_:1})])),_:1})]),y(f,{shadow:"never"},{default:b((()=>[k("div",X,[U((V(),$(j,{data:x(L),key:x(S),"highlight-current-row":"",height:"100%",stripe:""},{default:b((()=>[y(h,{prop:"name",label:"镜像名称",align:"center","min-width":"150","show-overflow-tooltip":"",fixed:"",sortable:""}),y(h,{prop:"number",label:"容器数量",align:"center","show-overflow-tooltip":"",width:"120",sortable:""}),y(h,{prop:"tag",label:"镜像 Tag",align:"center","show-overflow-tooltip":"",width:"120"}),y(h,{prop:"created",label:"创建时间",align:"center",width:"200",sortable:""}),y(h,{prop:"size",label:"镜像大小",align:"center",width:"120",sortable:""}),y(h,{label:"操作",width:"160",fixed:"right",align:"center"},{default:b((e=>[y(c,{type:"danger",plain:"",size:"small",onClick:a=>{return t=e.row.id,O.confirm("该操作会删除该镜像. 继续吗?","警告",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",beforeClose:(e,a,o)=>{"confirm"===e?(a.confirmButtonLoading=!0,g({image_id:t}).then((()=>{l({type:"success",message:"删除完成"})})).finally((()=>{a.confirmButtonLoading=!1,o(),D(),S.value+=1}))):o()}}).then((()=>{})).catch((()=>{l({type:"info",message:"删除取消"})})),void D();var t}},{default:b((()=>[B(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ie,x(J)]])]),k("div",q,[y(_,{locale:x(r)},{default:b((()=>[y(v,{"current-page":x(N).page,"onUpdate:currentPage":s[6]||(s[6]=e=>x(N).page=e),"page-size":x(N).size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":x(N).sizeOption,total:x(N).total,onSizeChange:x(N).onSizeChange,onCurrentChange:x(N).onPageChange},null,8,["current-page","page-size","page-sizes","total","onSizeChange","onCurrentChange"])])),_:1},8,["locale"])])])),_:1}),k("div",F,[y(te,{modelValue:x(Z),"onUpdate:modelValue":s[8]||(s[8]=e=>z(Z)?Z.value=e:null),title:"拉取镜像",width:"50%"},{default:b((()=>[y(w,{modelValue:x(M),"onUpdate:modelValue":s[7]||(s[7]=e=>z(M)?M.value=e:null),placeholder:"请输入镜像名称"},null,8,["modelValue"]),U((V(),$(c,{size:"default",type:"info",plain:"",onClick:Q},{default:b((()=>[B(" 确定 ")])),_:1})),[[ie,x(Y)]])])),_:1},8,["modelValue"])]),k("div",G,[y(te,{modelValue:x(ee),"onUpdate:modelValue":s[9]||(s[9]=e=>z(ee)?ee.value=e:null),title:"导入镜像",width:"50%"},{default:b((()=>[y(le,{drag:"",action:"/app/api/v1/container/image_import",headers:{Authorization:`Bearer ${x(A).user.token}`},limit:1,multiple:"","on-success":ae},{tip:b((()=>[I])),default:b((()=>[y(oe,{"icon-class":"upload"}),H])),_:1},8,["headers"])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-d67fd53e"]]);export{J as default};
