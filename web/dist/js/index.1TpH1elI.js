import"./el-button.ByR3JHUN.js";import{E as e,a,v as t}from"./el-table-column.B0Scj-yf.js";import{E as o}from"./el-progress.BHX3bato.js";import{_ as l}from"./index.C2vaOU_J.js";import{E as i}from"./el-dialog.unxo286u.js";import{a as s,s as r}from"./message.CkoferlE.js";import{u as n,z as p,E as d,a as m}from"./zh-cn.C893O-bB.js";/* empty css               */import"./el-select.j5yEBsKZ.js";import"./el-popper.BKYp1CmJ.js";import"./el-tooltip.l0sNRNKZ.js";import{E as u}from"./el-card.CLNklm4i.js";import{a as c,g,p as f,h}from"./index.YvLjsfvc.js";import{d as j,y as v,o as _,r as w,k as C,f as b,m as k,w as x,u as y,Y as z,F as E,a as V,A as B,e as U,b as S,S as $,U as A,_ as O}from"./index.B-t8Vh9z.js";import{E as T}from"./index.BExWLML1.js";import{E as D}from"./index.Ds87pwMy.js";import{E as L}from"./index.BsCNatce.js";import"./index.BRT_no80.js";import"./isEqual.C37xvCVZ.js";import"./_Uint8Array.DSPDeMoB.js";import"./use-form-item.B78Gt6sw.js";import"./_initCloneObject.BtMexjp3.js";import"./_baseClone.CBU-JaNq.js";import"./use-dialog.COk7vJ9u.js";import"./vnode.CyW5pdR-.js";import"./scroll.BSnWbwLk.js";import"./focus-trap.Csl5ah6L.js";import"./refs.C3kbUTVg.js";import"./index.9p5XnbQL.js";import"./castArray.Ch36ufQh.js";import"./index.CapyIjFA.js";import"./aria.C-hsWcn7.js";const P=e=>($("data-v-607ed9a5"),e=e(),A(),e),q={class:"am-image-title"},F={class:"am-image-operator"},I={class:"am-table"},H={class:"am-pagination"},J={class:"am-image-pull"},K={class:"am-image-import"},Q=P((()=>b("div",{class:"el-upload__text"},[B("Drop file here or "),b("em",null,"click to upload")],-1))),R=P((()=>b("div",{class:"el-upload__tip"},"tar/tar.gz files",-1))),W=O(j({__name:"index",setup(j){const $=v();_((()=>{P()}));const A=w(0),{data:O,refresh:P,loading:W,pagination:X}=n(c,{},{}),Y=()=>{f().then((()=>{s({type:"success",message:"清理完成"})}))},G=w(!1),M=w(!1),N=w(""),Z=async()=>{G.value=!0;let e={image_name:N.value};const{data:a}=await h(e);G.value=!1,M.value=!1,P()},ee=w(!1),ae=()=>{r("导入成功"),ee.value=!1,P()};return(r,n)=>{const c=D,f=u,h=e,j=a,v=d,_=m,w=L,te=i,oe=l,le=o,ie=t;return V(),C(E,null,[b("div",q,[b("span",{onClick:n[0]||(n[0]=e=>r.$router.push("/docker/container"))},"容器"),b("span",{onClick:n[1]||(n[1]=e=>r.$router.push("/docker/image"))},"镜像"),b("span",{onClick:n[2]||(n[2]=e=>r.$router.push("/docker/network"))},"网络"),b("span",{onClick:n[3]||(n[3]=e=>r.$router.push("/docker/settings"))},"设置")]),b("div",F,[k(f,{shadow:"never"},{default:x((()=>[k(c,{type:"primary",plain:"",onClick:n[4]||(n[4]=e=>M.value=!0)},{default:x((()=>[B("拉取镜像")])),_:1}),k(c,{type:"primary",plain:"",onClick:n[5]||(n[5]=e=>ee.value=!0)},{default:x((()=>[B("导入镜像")])),_:1}),k(c,{type:"warning",plain:"",onClick:Y},{default:x((()=>[B("清理虚悬镜像")])),_:1})])),_:1})]),k(f,{shadow:"never"},{default:x((()=>[b("div",I,[U((V(),S(j,{data:y(O),key:y(A),"highlight-current-row":"",height:"100%",stripe:""},{default:x((()=>[k(h,{prop:"id",label:"镜像 ID",align:"center",width:"120",fixed:"",sortable:""}),k(h,{prop:"name",label:"镜像名称",align:"center","min-width":"150","show-overflow-tooltip":"",fixed:"",sortable:""}),k(h,{prop:"number",label:"容器数量",align:"center","show-overflow-tooltip":"",width:"120",sortable:""}),k(h,{prop:"tag",label:"镜像 Tag",align:"center","show-overflow-tooltip":"",width:"120"}),k(h,{prop:"created",label:"创建时间",align:"center",width:"200",sortable:""}),k(h,{prop:"size",label:"镜像大小",align:"center",width:"120",sortable:""}),k(h,{label:"操作",width:"160",fixed:"right",align:"center"},{default:x((e=>[k(c,{type:"danger",plain:"",size:"small",onClick:a=>{return t=e.row.id,T.confirm("该操作会删除该镜像. 继续吗?","警告",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",beforeClose:(e,a,o)=>{"confirm"===e?(a.confirmButtonLoading=!0,g({image_id:t}).then((()=>{s({type:"success",message:"删除完成"})})).finally((()=>{a.confirmButtonLoading=!1,o(),P(),A.value+=1}))):o()}}).then((()=>{})).catch((()=>{s({type:"info",message:"删除取消"})})),void P();var t}},{default:x((()=>[B(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ie,y(W)]])]),b("div",H,[k(_,{locale:y(p)},{default:x((()=>[k(v,{"current-page":y(X).page,"onUpdate:currentPage":n[6]||(n[6]=e=>y(X).page=e),"page-size":y(X).size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":y(X).sizeOption,total:y(X).total,onSizeChange:y(X).onSizeChange,onCurrentChange:y(X).onPageChange},null,8,["current-page","page-size","page-sizes","total","onSizeChange","onCurrentChange"])])),_:1},8,["locale"])])])),_:1}),b("div",J,[k(te,{modelValue:y(M),"onUpdate:modelValue":n[8]||(n[8]=e=>z(M)?M.value=e:null),title:"拉取镜像",width:"50%"},{default:x((()=>[k(w,{modelValue:y(N),"onUpdate:modelValue":n[7]||(n[7]=e=>z(N)?N.value=e:null),placeholder:"请输入镜像名称"},null,8,["modelValue"]),U((V(),S(c,{size:"default",type:"info",plain:"",onClick:Z},{default:x((()=>[B(" 确定 ")])),_:1})),[[ie,y(G)]])])),_:1},8,["modelValue"])]),b("div",K,[k(te,{modelValue:y(ee),"onUpdate:modelValue":n[9]||(n[9]=e=>z(ee)?ee.value=e:null),title:"导入镜像",width:"50%"},{default:x((()=>[k(le,{drag:"",action:"/app/api/v1/container/image_import",headers:{Authorization:`Bearer ${y($).user.token}`},limit:1,multiple:"","on-success":ae},{tip:x((()=>[R])),default:x((()=>[k(oe,{"icon-class":"upload"}),Q])),_:1},8,["headers"])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-607ed9a5"]]);export{W as default};
