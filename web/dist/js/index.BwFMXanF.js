import"./el-button.wSr2vfOs.js";import{E as e,a,v as t}from"./el-table-column.CRjwOlSm.js";import{E as o}from"./el-progress.DD9jSVW7.js";import{_ as l}from"./index.vFwLIVie.js";import{E as i}from"./el-dialog.QrPPJRCD.js";import{a as s,s as r}from"./message.bOUkP4cz.js";import{u as n,z as p,E as d,a as m}from"./zh-cn.DsjAtiY-.js";/* empty css               */import"./el-select.Djdc0_BA.js";import"./el-popper.B5lc-jMO.js";import"./el-tooltip.l0sNRNKZ.js";import{E as u}from"./el-card.qxUhNo9k.js";import{a as c,g,p as f,h}from"./index.BmMGee4z.js";import{d as j,y as v,o as _,r as w,k as C,f as b,m as k,w as x,u as y,Y as z,F as E,a as V,A as U,e as A,b as B,S,U as $,_ as O}from"./index.C-XteKAQ.js";import{E as T}from"./index.BsLDvSMs.js";import{E as L}from"./index.BusDn2qi.js";import{E as P}from"./index.W1JDYdlb.js";import"./index.HJW_Xvjo.js";import"./isEqual.Bn-GIEBR.js";import"./_Uint8Array.DhThSVct.js";import"./use-form-item.BHwM85F6.js";import"./_initCloneObject.A5AD6tfW.js";import"./_baseClone.BXZGK5jP.js";import"./use-dialog.0QHuDEHA.js";import"./vnode.DQET2EQQ.js";import"./scroll.COMsDKDo.js";import"./focus-trap.BwkBla3c.js";import"./refs.D6GIAKzc.js";import"./index.BYpNppOK.js";import"./castArray.DN6WFAt4.js";import"./index.Bs0cFoC_.js";import"./aria.C-hsWcn7.js";const q=e=>(S("data-v-607ed9a5"),e=e(),$(),e),D={class:"am-image-title"},I={class:"am-image-operator"},K={class:"am-table"},F={class:"am-pagination"},G={class:"am-image-pull"},H={class:"am-image-import"},M=q((()=>b("div",{class:"el-upload__text"},[U("Drop file here or "),b("em",null,"click to upload")],-1))),N=q((()=>b("div",{class:"el-upload__tip"},"tar/tar.gz files",-1))),Y=O(j({__name:"index",setup(j){const S=v();_((()=>{q()}));const $=w(0),{data:O,refresh:q,loading:Y,pagination:J}=n(c,{},{}),Q=()=>{f().then((()=>{s({type:"success",message:"清理完成"})}))},R=w(!1),W=w(!1),X=w(""),Z=async()=>{R.value=!0;let e={image_name:X.value};const{data:a}=await h(e);R.value=!1,W.value=!1,q()},ee=w(!1),ae=()=>{r("导入成功"),ee.value=!1,q()};return(r,n)=>{const c=L,f=u,h=e,j=a,v=d,_=m,w=P,te=i,oe=l,le=o,ie=t;return V(),C(E,null,[b("div",D,[b("span",{onClick:n[0]||(n[0]=e=>r.$router.push("/docker/container"))},"容器"),b("span",{onClick:n[1]||(n[1]=e=>r.$router.push("/docker/image"))},"镜像"),b("span",{onClick:n[2]||(n[2]=e=>r.$router.push("/docker/network"))},"网络"),b("span",{onClick:n[3]||(n[3]=e=>r.$router.push("/docker/settings"))},"设置")]),b("div",I,[k(f,{shadow:"never"},{default:x((()=>[k(c,{type:"primary",plain:"",onClick:n[4]||(n[4]=e=>W.value=!0)},{default:x((()=>[U("拉取镜像")])),_:1}),k(c,{type:"primary",plain:"",onClick:n[5]||(n[5]=e=>ee.value=!0)},{default:x((()=>[U("导入镜像")])),_:1}),k(c,{type:"warning",plain:"",onClick:Q},{default:x((()=>[U("清理虚悬镜像")])),_:1})])),_:1})]),k(f,{shadow:"never"},{default:x((()=>[b("div",K,[A((V(),B(j,{data:y(O),key:y($),"highlight-current-row":"",height:"100%",stripe:""},{default:x((()=>[k(h,{prop:"id",label:"镜像 ID",align:"center",width:"120",fixed:"",sortable:""}),k(h,{prop:"name",label:"镜像名称",align:"center","min-width":"150","show-overflow-tooltip":"",fixed:"",sortable:""}),k(h,{prop:"number",label:"容器数量",align:"center","show-overflow-tooltip":"",width:"120",sortable:""}),k(h,{prop:"tag",label:"镜像 Tag",align:"center","show-overflow-tooltip":"",width:"120"}),k(h,{prop:"created",label:"创建时间",align:"center",width:"200",sortable:""}),k(h,{prop:"size",label:"镜像大小",align:"center",width:"120",sortable:""}),k(h,{label:"操作",width:"160",fixed:"right",align:"center"},{default:x((e=>[k(c,{type:"danger",plain:"",size:"small",onClick:a=>{return t=e.row.id,T.confirm("该操作会删除该镜像. 继续吗?","警告",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",beforeClose:(e,a,o)=>{"confirm"===e?(a.confirmButtonLoading=!0,g({image_id:t}).then((()=>{s({type:"success",message:"删除完成"})})).finally((()=>{a.confirmButtonLoading=!1,o(),q(),$.value+=1}))):o()}}).then((()=>{})).catch((()=>{s({type:"info",message:"删除取消"})})),void q();var t}},{default:x((()=>[U(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ie,y(Y)]])]),b("div",F,[k(_,{locale:y(p)},{default:x((()=>[k(v,{"current-page":y(J).page,"onUpdate:currentPage":n[6]||(n[6]=e=>y(J).page=e),"page-size":y(J).size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":y(J).sizeOption,total:y(J).total,onSizeChange:y(J).onSizeChange,onCurrentChange:y(J).onPageChange},null,8,["current-page","page-size","page-sizes","total","onSizeChange","onCurrentChange"])])),_:1},8,["locale"])])])),_:1}),b("div",G,[k(te,{modelValue:y(W),"onUpdate:modelValue":n[8]||(n[8]=e=>z(W)?W.value=e:null),title:"拉取镜像",width:"50%"},{default:x((()=>[k(w,{modelValue:y(X),"onUpdate:modelValue":n[7]||(n[7]=e=>z(X)?X.value=e:null),placeholder:"请输入镜像名称"},null,8,["modelValue"]),A((V(),B(c,{size:"default",type:"info",plain:"",onClick:Z},{default:x((()=>[U(" 确定 ")])),_:1})),[[ie,y(R)]])])),_:1},8,["modelValue"])]),b("div",H,[k(te,{modelValue:y(ee),"onUpdate:modelValue":n[9]||(n[9]=e=>z(ee)?ee.value=e:null),title:"导入镜像",width:"50%"},{default:x((()=>[k(le,{drag:"",action:"/app/api/v1/container/image_import",headers:{Authorization:`Bearer ${y(S).user.token}`},limit:1,multiple:"","on-success":ae},{tip:x((()=>[N])),default:x((()=>[k(oe,{"icon-class":"upload"}),M])),_:1},8,["headers"])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-607ed9a5"]]);export{Y as default};
