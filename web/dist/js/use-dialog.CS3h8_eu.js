import{j as e,c as o,p as t,as as l,o as n,r as a,b as s,d as u,i as r,P as c,ao as d,at as i,k as p,au as f,a as m}from"./el-button.Bf-OVv06.js";import{X as y,c as v,B as b,ap as C,a5 as g,d as x,m as k,j as B,I as M,r as w,M as S,o as h,J as I}from"./index.Dtsxs5-j.js";import{P as j}from"./vnode.C8vko7L8.js";import{U as D}from"./event.BwRzfsZt.js";import{u as E}from"./use-form-item.vgwZ2Rnc.js";import{t as O}from"./index.DhER-06O.js";import{g as z}from"./scroll.BeZ43HJL.js";import{i as A}from"./focus-trap.BiItK6l-.js";const F=(s,u={})=>{y(s)||O("[useLockscreen]","You need to pass a ref param to this function");const r=u.ns||e("popup"),c=v((()=>r.bm("parent","hidden")));if(!o||t(document.body,c.value))return;let d=0,i=!1,p="0";const f=()=>{setTimeout((()=>{a(null==document?void 0:document.body,c.value),i&&document&&(document.body.style.width=p)}),200)};b(s,(e=>{if(!e)return void f();i=!t(document.body,c.value),i&&(p=document.body.style.width),d=z(r.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,a=l(document.body,"overflowY");d>0&&(o||"scroll"===a)&&i&&(document.body.style.width=`calc(100% - ${d}px)`),n(document.body,c.value)})),C((()=>f()))},L=e=>{if(!e)return{onClick:g,onMousedown:g,onMouseup:g};let o=!1,t=!1;return{onClick:l=>{o&&t&&e(l),o=t=!1},onMousedown:e=>{o=e.target===e.currentTarget},onMouseup:e=>{t=e.target===e.currentTarget}}},P=s({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:u([String,Array,Object])},zIndex:{type:u([String,Number])}});const T=x({name:"ElOverlay",props:P,emits:{click:e=>e instanceof MouseEvent},setup(o,{slots:t,emit:l}){const n=e("overlay"),{onClick:a,onMousedown:s,onMouseup:u}=L(o.customMaskEvent?void 0:e=>{l("click",e)});return()=>o.mask?k("div",{class:[n.b(),o.overlayClass],style:{zIndex:o.zIndex},onClick:a,onMousedown:s,onMouseup:u},[B(t,"default")],j.STYLE|j.CLASS|j.PROPS,["onClick","onMouseup","onMousedown"]):M("div",{class:o.overlayClass,style:{zIndex:o.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[B(t,"default")])}}),N=s({center:Boolean,alignCenter:Boolean,closeIcon:{type:r},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),$={close:()=>!0},R=s({...N,appendToBody:Boolean,appendTo:{type:u(String),default:"body"},beforeClose:{type:u(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),V={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[D]:e=>c(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Y=(e,t)=>{var l;const n=I().emit,{nextZIndex:a}=d();let s="";const u=E(),r=E(),c=w(!1),y=w(!1),C=w(!1),g=w(null!=(l=e.zIndex)?l:a());let x,k;const B=i("namespace",f),M=v((()=>{const o={},t=`--${B.value}-dialog`;return e.fullscreen||(e.top&&(o[`${t}-margin-top`]=e.top),e.width&&(o[`${t}-width`]=p(e.width))),o})),j=v((()=>e.alignCenter?{display:"flex"}:{}));function O(){null==k||k(),null==x||x(),e.openDelay&&e.openDelay>0?({stop:x}=m((()=>P()),e.openDelay)):P()}function z(){null==x||x(),null==k||k(),e.closeDelay&&e.closeDelay>0?({stop:k}=m((()=>T()),e.closeDelay)):T()}function L(){e.beforeClose?e.beforeClose((function(e){e||(y.value=!0,c.value=!1)})):z()}function P(){o&&(c.value=!0)}function T(){c.value=!1}return e.lockScroll&&F(c),b((()=>e.modelValue),(o=>{o?(y.value=!1,O(),C.value=!0,g.value=A(e.zIndex)?a():g.value++,S((()=>{n("open"),t.value&&(t.value.scrollTop=0)}))):c.value&&z()})),b((()=>e.fullscreen),(e=>{t.value&&(e?(s=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=s)})),h((()=>{e.modelValue&&(c.value=!0,C.value=!0,O())})),{afterEnter:function(){n("opened")},afterLeave:function(){n("closed"),n(D,!1),e.destroyOnClose&&(C.value=!1)},beforeLeave:function(){n("close")},handleClose:L,onModalClick:function(){e.closeOnClickModal&&L()},close:z,doClose:T,onOpenAutoFocus:function(){n("openAutoFocus")},onCloseAutoFocus:function(){n("closeAutoFocus")},onCloseRequested:function(){e.closeOnPressEscape&&L()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:u,bodyId:r,closed:y,style:M,overlayDialogStyle:j,rendered:C,visible:c,zIndex:g}};export{T as E,L as a,$ as b,R as c,N as d,V as e,Y as f,F as u};
