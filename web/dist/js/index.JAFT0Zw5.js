import"./el-button.Bf-OVv06.js";import{E as e}from"./el-drawer.--C-lpCR.js";import{s as l}from"./message.ohA7tZs1.js";import{a,E as t}from"./el-form-item.M-ghQCfn.js";/* empty css               */import{E as o,a as i}from"./el-select.B5MNdMFy.js";import"./el-popper.Cq1hAJs-.js";import{E as s}from"./el-card.vZ36OKf6.js";import{E as r,a as d}from"./el-descriptions-item.Doyu0KGy.js";import{_ as u}from"./index.DcE9Scjy.js";import{r as m}from"./index.Ct-vKfEQ.js";import{E as n}from"./index.eDhpYl8G.js";import{E as p}from"./index.7fU9QC-V.js";import{d as h,o as v,r as f,k as c,f as y,m as _,w as b,u as j,X as x,F as V,a as C,t as g,A as k,P as U,_ as z}from"./index.Dtsxs5-j.js";import"./use-dialog.CS3h8_eu.js";import"./vnode.C8vko7L8.js";import"./event.BwRzfsZt.js";import"./use-form-item.vgwZ2Rnc.js";import"./index.DhER-06O.js";import"./scroll.BeZ43HJL.js";import"./focus-trap.BiItK6l-.js";import"./castArray.B6kcHc-f.js";import"./_baseClone.Cjz58nAh.js";import"./_Uint8Array.DZ6GMUyG.js";import"./_initCloneObject.L1lxMjk_.js";import"./index.BslPTDkf.js";import"./token.DWNpOE8r.js";import"./isEqual.DXE01s-J.js";function w(e){return m.post("/api/v1/alarm/alarm_update",e)}const E={class:"am-alarm-title"},P={style:{"margin-right":"8px"}},A={style:{"margin-right":"8px"}},N={style:{"margin-right":"8px"}},R=z(h({__name:"index",setup(h){v((async()=>{const{data:e}=await m.get("/api/v1/alarm/alarm_query");for(const l of e.data)"cpu"===l.type?(z.value.id=l.id,z.value.duration=l.duration,z.value.threshold=l.threshold):"memory"===l.type?(R.value.id=l.id,R.value.duration=l.duration,R.value.threshold=l.threshold):"disk"===l.type&&(S.value.id=l.id,S.value.duration=l.duration,S.value.threshold=l.threshold)}));const z=f({id:1,duration:2,threshold:80}),R=f({id:2,duration:2,threshold:80}),S=f({id:3,duration:2,threshold:80}),$=f(!1),q=()=>$.value=!0,D=()=>$.value=!1,B=()=>{w({id:z.value.id,type:"cpu",duration:z.value.duration,threshold:Number(z.value.threshold)}).catch((e=>{})).finally((()=>{l("修改成功"),$.value=!1}))},F=[{value:2,label:"2分钟"},{value:3,label:"3分钟"},{value:4,label:"4分钟"},{value:5,label:"5分钟"},{value:6,label:"6分钟"},{value:7,label:"7分钟"},{value:8,label:"8分钟"},{value:9,label:"9分钟"},{value:10,label:"10分钟"}],G=f(!1),I=()=>G.value=!0,J=()=>G.value=!1,K=()=>{w({id:R.value.id,type:"memory",duration:R.value.duration,threshold:Number(R.value.threshold)}).finally((()=>{l("修改成功"),G.value=!1}))},M=f(!1),O=()=>M.value=!0,W=()=>M.value=!1,X=()=>{w({id:S.value.id,type:"disk",duration:S.value.duration,threshold:Number(S.value.threshold)}).finally((()=>{l("修改成功"),M.value=!1}))};return(l,m)=>{const h=u,v=r,f=d,w=s,H=i,L=o,Q=n,T=a,Y=t,Z=p,ee=e;return C(),c(V,null,[y("div",E,[y("span",{onClick:m[0]||(m[0]=e=>l.$router.push("/alarm/mail"))},"告警配置"),y("span",{onClick:m[1]||(m[1]=e=>l.$router.push("/alarm/threshold"))},"告警阈值")]),_(w,{shadow:"never"},{default:b((()=>[_(f,{title:"主机运行状态",column:1},{default:b((()=>[_(v,{label:"CPU 使用率过高"},{default:b((()=>[y("span",P,"CPU 使率连续 "+g(j(z).duration)+" 分钟超过 "+g(j(z).threshold)+"%",1),_(h,{"icon-class":"edit",style:{cursor:"pointer"},onClick:q})])),_:1}),_(v,{label:"内存使用率过高"},{default:b((()=>[y("span",A,"内存使用率连续 "+g(j(R).duration)+" 分钟超过 "+g(j(R).threshold)+"%",1),_(h,{"icon-class":"edit",style:{cursor:"pointer"},onClick:I})])),_:1}),_(v,{label:"磁盘使用率过高"},{default:b((()=>[y("span",N,"磁盘使用率超过 "+g(j(S).threshold)+"%",1),_(h,{"icon-class":"edit",style:{cursor:"pointer"},onClick:O})])),_:1})])),_:1})])),_:1}),_(ee,{modelValue:j($),"onUpdate:modelValue":m[4]||(m[4]=e=>x($)?$.value=e:null),size:"560",title:"编辑 CPU 使用率过高"},{default:b((()=>[_(Y,{ref:"CPUSettingRef",model:j(z),"label-width":"120px","label-position":"left"},{default:b((()=>[_(T,{prop:"server",label:"CPU 使用率过高"},{default:b((()=>[k(" CPU 使用率连续 "),_(L,{modelValue:j(z).duration,"onUpdate:modelValue":m[2]||(m[2]=e=>j(z).duration=e),size:"small",style:{width:"100px",margin:"0 4px"}},{default:b((()=>[(C(),c(V,null,U(F,(e=>_(H,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),64))])),_:1},8,["modelValue"]),k(" 超过 "),_(Q,{modelValue:j(z).threshold,"onUpdate:modelValue":m[3]||(m[3]=e=>j(z).threshold=e),size:"small",style:{width:"140px",margin:"0 4px"}},{append:b((()=>[k("%")])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),_(Z,{type:"default",size:"small",plain:"",onClick:D},{default:b((()=>[k("取消")])),_:1}),_(Z,{type:"primary",size:"small",plain:"",onClick:B},{default:b((()=>[k("确定")])),_:1})])),_:1},8,["modelValue"]),_(ee,{modelValue:j(G),"onUpdate:modelValue":m[7]||(m[7]=e=>x(G)?G.value=e:null),size:"560",title:"编辑内存使用率过高"},{default:b((()=>[_(Y,{ref:"MemorySettingRef",model:j(R),"label-width":"120px","label-position":"left"},{default:b((()=>[_(T,{prop:"server",label:"内存使用率过高"},{default:b((()=>[k(" CPU 使用率连续 "),_(L,{modelValue:j(R).duration,"onUpdate:modelValue":m[5]||(m[5]=e=>j(R).duration=e),size:"small",style:{width:"100px",margin:"0 4px"}},{default:b((()=>[(C(),c(V,null,U(F,(e=>_(H,{key:e.value,value:e.value,label:e.label},null,8,["value","label"]))),64))])),_:1},8,["modelValue"]),k(" 超过 "),_(Q,{modelValue:j(R).threshold,"onUpdate:modelValue":m[6]||(m[6]=e=>j(R).threshold=e),size:"small",style:{width:"140px",margin:"0 4px"}},{append:b((()=>[k("%")])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),_(Z,{type:"default",size:"small",plain:"",onClick:J},{default:b((()=>[k("取消")])),_:1}),_(Z,{type:"primary",size:"small",plain:"",onClick:K},{default:b((()=>[k("确定")])),_:1})])),_:1},8,["modelValue"]),_(ee,{modelValue:j(M),"onUpdate:modelValue":m[9]||(m[9]=e=>x(M)?M.value=e:null),size:"560",title:"编辑磁盘使用率过高"},{default:b((()=>[_(Y,{ref:"DiskSettingRef",model:j(S),"label-width":"120px","label-position":"left"},{default:b((()=>[_(T,{prop:"server",label:"磁盘使用率过高"},{default:b((()=>[k(" 磁盘使用率超过 "),_(Q,{modelValue:j(S).threshold,"onUpdate:modelValue":m[8]||(m[8]=e=>j(S).threshold=e),size:"small",style:{width:"140px",margin:"0 4px"}},{append:b((()=>[k("%")])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),_(Z,{type:"default",size:"small",plain:"",onClick:W},{default:b((()=>[k("取消")])),_:1}),_(Z,{type:"primary",size:"small",plain:"",onClick:X},{default:b((()=>[k("确定")])),_:1})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-82176801"]]);export{R as default};
