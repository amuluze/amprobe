var e=Object.defineProperty,a=(a,l,o)=>((a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o)(a,"symbol"!=typeof l?l+"":l,o);import{N as l,E as o,_ as t,C as s,O as r,h as n,w as i}from"./el-input.DbwAcvyl.js";import{u as d,z as c,E as u,a as p,b as f,c as m,v}from"./zh-cn.D__ZzpjP.js";import{d as h,a as g,b as w,c as y,u as b,E as _}from"./el-drawer.BE1h0dkC.js";import"./el-overlay.CO8zOjxP.js";import{E as C}from"./el-tag.Ddt9mnZw.js";import"./el-select.RsKGHFHP.js";import"./el-popper.DO2DqAkm.js";import"./el-tooltip.l0sNRNKZ.js";import{c as k,E as j,a as x,b as z}from"./el-dropdown-item.COMtvSy9.js";import{E}from"./el-card.BatDINaT.js";import{q as $,s as A,c as R,r as I,d as F}from"./index.xHIKB6D5.js";import{E as P}from"./index.DLxQFyR-.js";import{d as T,h as V,c as L,o as U,e as B,D as M,f as D,n as O,u as S,B as q,m as K,v as G,x as H,y as J,C as N,z as W,s as Q,r as X,p as Y,E as Z,P as ee,a5 as ae,G as le,I as oe,a6 as te,j as se,a1 as re,F as ne,A as ie,_ as de}from"./index.CWaAX4xr.js";import{E as ce,u as ue}from"./index.BXhqqwsx.js";import{F as pe,E as fe}from"./focus-trap.D7-xhyEd.js";import{u as me,E as ve}from"./index.CGHORWa1.js";import{E as he}from"./index.DYeR_yRe.js";import{E as ge}from"./index.DjAzOcH0.js";import"./index.BCafUqtM.js";import"./_Uint8Array.BilG7pSd.js";import"./use-form-item.BVm2y5eZ.js";import"./_initCloneObject.ByLqx6c6.js";import"./scroll.CZcvdlp5.js";import"./castArray.BKnkx244.js";import"./vnode.Dqp4nsAX.js";import"./aria.C-hsWcn7.js";const we=Symbol("dialogInjectionKey"),ye=["aria-level"],be=["aria-label"],_e=["id"],Ce=T({name:"ElDialogContent"});var ke=t(T({...Ce,props:h,emits:g,setup(e){const a=e,{t:t}=l(),{Close:r}=s,{dialogRef:n,headerRef:i,bodyId:d,ns:c,style:u}=V(we),{focusTrapRef:p}=V(pe),f=L((()=>[c.b(),c.is("fullscreen",a.fullscreen),c.is("draggable",a.draggable),c.is("align-center",a.alignCenter),{[c.m("center")]:a.center}])),m=k(p,n),v=L((()=>a.draggable)),h=L((()=>a.overflow));return me(n,i,v,h),(e,a)=>(U(),B("div",{ref:S(m),class:O(S(f)),style:W(S(u)),tabindex:"-1"},[M("header",{ref_key:"headerRef",ref:i,class:O([S(c).e("header"),{"show-close":e.showClose}])},[D(e.$slots,"header",{},(()=>[M("span",{role:"heading","aria-level":e.ariaLevel,class:O(S(c).e("title"))},q(e.title),11,ye)])),e.showClose?(U(),B("button",{key:0,"aria-label":S(t)("el.dialog.close"),class:O(S(c).e("headerbtn")),type:"button",onClick:a[0]||(a[0]=a=>e.$emit("close"))},[K(S(o),{class:O(S(c).e("close"))},{default:G((()=>[(U(),H(J(e.closeIcon||S(r))))])),_:1},8,["class"])],10,be)):N("v-if",!0)],2),M("div",{id:S(d),class:O(S(c).e("body"))},[D(e.$slots,"default")],10,_e),e.$slots.footer?(U(),B("footer",{key:0,class:O(S(c).e("footer"))},[D(e.$slots,"footer")],2)):N("v-if",!0)],6))}}),[["__file","dialog-content.vue"]]);const je=["aria-label","aria-labelledby","aria-describedby"],xe=T({name:"ElDialog",inheritAttrs:!1});const ze=i(t(T({...xe,props:w,emits:y,setup(e,{expose:a}){const l=e,o=Q();r({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},L((()=>!!o.title)));const t=n("dialog"),s=X(),i=X(),d=X(),{visible:c,titleId:u,bodyId:p,style:f,overlayDialogStyle:m,rendered:v,zIndex:h,afterEnter:g,afterLeave:w,beforeLeave:y,handleClose:_,onModalClick:C,onOpenAutoFocus:k,onCloseAutoFocus:j,onCloseRequested:x,onFocusoutPrevented:z}=b(l,s);Y(we,{dialogRef:s,headerRef:i,bodyId:p,ns:t,rendered:v,style:f});const E=ue(C),$=L((()=>l.draggable&&!l.fullscreen));return a({visible:c,dialogContentRef:d}),(e,a)=>(U(),H(te,{to:e.appendTo,disabled:"body"===e.appendTo&&!e.appendToBody},[K(oe,{name:"dialog-fade",onAfterEnter:S(g),onAfterLeave:S(w),onBeforeLeave:S(y),persisted:""},{default:G((()=>[Z(K(S(ce),{"custom-mask-event":"",mask:e.modal,"overlay-class":e.modalClass,"z-index":S(h)},{default:G((()=>[M("div",{role:"dialog","aria-modal":"true","aria-label":e.title||void 0,"aria-labelledby":e.title?void 0:S(u),"aria-describedby":S(p),class:O(`${S(t).namespace.value}-overlay-dialog`),style:W(S(m)),onClick:a[0]||(a[0]=(...e)=>S(E).onClick&&S(E).onClick(...e)),onMousedown:a[1]||(a[1]=(...e)=>S(E).onMousedown&&S(E).onMousedown(...e)),onMouseup:a[2]||(a[2]=(...e)=>S(E).onMouseup&&S(E).onMouseup(...e))},[K(S(fe),{loop:"",trapped:S(c),"focus-start-el":"container",onFocusAfterTrapped:S(k),onFocusAfterReleased:S(j),onFocusoutPrevented:S(z),onReleaseRequested:S(x)},{default:G((()=>[S(v)?(U(),H(ke,ee({key:0,ref_key:"dialogContentRef",ref:d},e.$attrs,{center:e.center,"align-center":e.alignCenter,"close-icon":e.closeIcon,draggable:S($),overflow:e.overflow,fullscreen:e.fullscreen,"show-close":e.showClose,title:e.title,"aria-level":e.headerAriaLevel,onClose:S(_)}),ae({header:G((()=>[e.$slots.title?D(e.$slots,"title",{key:1}):D(e.$slots,"header",{key:0,close:S(_),titleId:S(u),titleClass:S(t).e("title")})])),default:G((()=>[D(e.$slots,"default")])),_:2},[e.$slots.footer?{name:"footer",fn:G((()=>[D(e.$slots,"footer")]))}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):N("v-if",!0)])),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,je)])),_:3},8,["mask","overlay-class","z-index"]),[[le,S(c)]])])),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["to","disabled"]))}}),[["__file","dialog.vue"]]));class Ee{constructor(e,l=null,o=null,t=null,s=null){a(this,"url"),a(this,"ws"),a(this,"close"),a(this,"send");let r=window.location;e=r.host+"/"+e,this.url=/https/.test(r.protocol)?"wss://"+e:"ws://"+e,this.ws=new WebSocket(this.url),this.close=()=>{this.ws.close()},this.send=e=>{this.ws.send(e)},this.ws.onopen=e=>{null!==l&&l(this,e)},this.ws.onmessage=e=>{null!==o&&o(this,e)},this.ws.onerror=e=>{null!=t&&t(this,e)},this.ws.onclose=e=>{null!==s&&s(this,e)}}}const $e={class:"am-container-title"},Ae={class:"am-container-operator"},Re={class:"am-table"},Ie={class:"am-pagination"},Fe={class:"dialog-footer"},Pe={class:"am-container-create"},Te={class:"am-container-create__operator"},Ve=de(T({__name:"index",setup(e){se((()=>{o()}));const a={},{data:l,refresh:o,loading:t,pagination:s}=d($,{},{}),r=X(!1),n=X(0),i=X("");let h;const g=()=>{r.value=!1,h.close()},w=()=>{h.close()},y=()=>{const e=document.createElement("a");e.setAttribute("href",`data:text/plain;charset=utf-8,${encodeURIComponent(i.value)}`),e.setAttribute("download","log.txt"),e.style.display="none",e.click()},b=X(!1);return(e,d)=>{const k=he,$=E,T=u,V=C,L=j,D=x,O=z,J=p,N=f,W=m,Q=ge,X=ze,Y=_,ee=v;return U(),B(ne,null,[M("div",$e,[M("span",{onClick:d[0]||(d[0]=a=>e.$router.push("/docker/container"))},"容器"),M("span",{onClick:d[1]||(d[1]=a=>e.$router.push("/docker/image"))},"镜像"),M("span",{onClick:d[2]||(d[2]=a=>e.$router.push("/docker/network"))},"网络"),M("span",{onClick:d[3]||(d[3]=a=>e.$router.push("/docker/settings"))},"设置")]),M("div",Ae,[K($,{shadow:"never"},{default:G((()=>[K(k,{type:"primary",onClick:d[4]||(d[4]=e=>b.value=!0)},{default:G((()=>[ie("创建容器")])),_:1}),K(k,{type:"warning"},{default:G((()=>[ie("清理容器")])),_:1})])),_:1})]),K($,{shadow:"never"},{default:G((()=>[M("div",Re,[Z((U(),H(J,{data:S(l),key:S(n),stripe:"",ref:"multipleTable"},{default:G((()=>[K(T,{prop:"id",label:"容器 ID","min-width":"100",align:"center",fixed:"",sortable:""}),K(T,{prop:"name",label:"容器名称",align:"center","min-width":"120","show-overflow-tooltip":"",fixed:"",sortable:""}),K(T,{prop:"image",label:"镜像名称",align:"center","min-width":"120","show-overflow-tooltip":"",sortable:""}),K(T,{prop:"ip",label:"容器 IP",align:"center","min-width":"100","show-overflow-tooltip":"",sortable:""}),K(T,{prop:"state",label:"运行状态",align:"center","min-width":"120","show-overflow-tooltip":""},{default:G((e=>[K(V,{type:"running"===e.row.state?"success":"danger"},{default:G((()=>[ie(q(e.row.state),1)])),_:2},1032,["type"])])),_:1}),K(T,{prop:"uptime",label:"启动时间",align:"center","min-width":"120","show-overflow-tooltip":"",sortable:""}),K(T,{prop:"cpu_percent",label:"CPU使用率",align:"center","min-width":"130","show-overflow-tooltip":"",sortable:""}),K(T,{prop:"memory_percent",label:"内存使用率",align:"center","min-width":"130","show-overflow-tooltip":"",sortable:""}),K(T,{prop:"memory_usage",label:"内存使用量",align:"center","min-width":"130","show-overflow-tooltip":"",sortable:""}),K(T,{prop:"memory_limit",label:"内存限制",align:"center","min-width":"120","show-overflow-tooltip":""}),K(T,{label:"操作",width:"200",fixed:"right",align:"center"},{default:G((e=>[K(k,{type:"primary",size:"small",text:"",onClick:a=>{return l=e.row.id,i.value="",r.value=!0,void(h=new Ee("ws/"+l,((e,a)=>{e.send(l)}),((e,a)=>{i.value=i.value+"\n"+a.data})));var l}},{default:G((()=>[ie(" 日志 ")])),_:2},1032,["onClick"]),K(k,{type:"primary",size:"small",text:"",onClick:a=>{return l=e.row.id,void A({container_id:l}).finally((()=>{o(),n.value+=1}));var l}},{default:G((()=>[ie(" 启动 ")])),_:2},1032,["onClick"]),K(O,null,{dropdown:G((()=>[K(D,null,{default:G((()=>[K(L,null,{default:G((()=>[K(k,{type:"warning",size:"small",text:"",onClick:a=>{return l=e.row.id,void R({container_id:l}).finally((()=>{o(),n.value+=1}));var l}},{default:G((()=>[ie(" 停止 ")])),_:2},1032,["onClick"])])),_:2},1024),K(L,null,{default:G((()=>[K(k,{type:"warning",size:"small",text:"",onClick:a=>{return l=e.row.id,void I({container_id:l}).finally((()=>{o(),n.value+=1}));var l}},{default:G((()=>[ie(" 重启 ")])),_:2},1032,["onClick"])])),_:2},1024),K(L,null,{default:G((()=>[K(k,{type:"danger",size:"small",text:"",onClick:a=>{return l=e.row.id,void ve.confirm("该操作会强制删除该容器. 继续吗?","警告",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((()=>{F({container_id:l}).then((()=>{P({type:"success",message:"删除完成"})})).finally((()=>{o(),n.value+=1}))})).catch((()=>{P({type:"info",message:"删除取消"})}));var l}},{default:G((()=>[ie(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),default:G((()=>[K(k,{type:"primary",size:"small",text:""},{default:G((()=>[ie("更多")])),_:1})])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[ee,S(t)]])]),M("div",Ie,[K(W,{locale:S(c)},{default:G((()=>[K(N,{"current-page":S(s).page,"onUpdate:currentPage":d[5]||(d[5]=e=>S(s).page=e),"page-size":S(s).size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":S(s).sizeOption,total:S(s).total,onSizeChange:d[6]||(d[6]=e=>S(s).onSizeChange(e,a)),onCurrentChange:d[7]||(d[7]=e=>S(s).onPageChange(e,a))},null,8,["current-page","page-size","page-sizes","total"])])),_:1},8,["locale"])])])),_:1}),K(X,{modelValue:S(r),"onUpdate:modelValue":d[9]||(d[9]=e=>re(r)?r.value=e:null),title:"日志",width:"50%","before-close":g},{footer:G((()=>[M("div",Fe,[K(k,{size:"small",type:"primary",plain:"",onClick:y},{default:G((()=>[ie("下载")])),_:1}),K(k,{size:"small",type:"info",plain:"",onClick:w},{default:G((()=>[ie("停止")])),_:1}),K(k,{size:"small",type:"success",plain:"",onClick:g},{default:G((()=>[ie("关闭")])),_:1})])])),default:G((()=>[K(Q,{modelValue:S(i),"onUpdate:modelValue":d[8]||(d[8]=e=>re(i)?i.value=e:null),rows:"20",type:"textarea"},null,8,["modelValue"])])),_:1},8,["modelValue"]),M("div",Pe,[K(Y,{modelValue:S(b),"onUpdate:modelValue":d[10]||(d[10]=e=>re(b)?b.value=e:null),size:"540",title:"创建容器"},{default:G((()=>[M("div",Te,[K(k,{type:"default",size:"default",plain:""},{default:G((()=>[ie("取消")])),_:1}),K(k,{type:"primary",size:"default",plain:""},{default:G((()=>[ie("确定")])),_:1})])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-93ede201"]]);export{Ve as default};
