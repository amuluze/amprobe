import{b as e,i as a,d as l,P as t,h as i,z as s,j as o,H as r,k as n,O as u,E as d,Q as c,_ as m,m as p}from"./el-button.Bf-OVv06.js";import{v}from"./el-loading.8LoI83hF.js";import{E as f}from"./el-drawer.--C-lpCR.js";import"./message.ohA7tZs1.js";import{a as b,E as _}from"./el-form-item.M-ghQCfn.js";import"./el-tooltip.l0sNRNKZ.js";import{E as y}from"./el-popper.Cq1hAJs-.js";/* empty css               */import{E as k,a as h}from"./el-select.B5MNdMFy.js";import{E as V,a as g}from"./el-table-column.ROcqc2dJ.js";import{E as w}from"./el-card.vZ36OKf6.js";import{q as x,a as j,c as I,d as C,u as U}from"./index.CmOgbRgk.js";import{E}from"./index.7fU9QC-V.js";import{E as S}from"./index.BslPTDkf.js";import{E as T}from"./index.eDhpYl8G.js";import{q as z,d as A,c as B,r as N,B as P,o as q,a as $,k as K,f as R,u as F,n as L,a6 as O,b as X,w as D,h as H,i as J,t as M,m as Q,j as W,g as G,l as Y,M as Z,ac as ee,x as ae,X as le,F as te,A as ie,e as se,P as oe,_ as re}from"./index.Dtsxs5-j.js";import{i as ne}from"./validator.CO8k0rS7.js";import{u as ue,d as de,t as ce}from"./index.DhER-06O.js";import{U as me,C as pe,I as ve}from"./event.BwRzfsZt.js";import{a as fe,b as be}from"./use-form-item.vgwZ2Rnc.js";import"./use-dialog.CS3h8_eu.js";import"./vnode.C8vko7L8.js";import"./scroll.BeZ43HJL.js";import"./focus-trap.BiItK6l-.js";import"./castArray.B6kcHc-f.js";import"./_baseClone.Cjz58nAh.js";import"./_Uint8Array.DZ6GMUyG.js";import"./_initCloneObject.L1lxMjk_.js";import"./token.DWNpOE8r.js";import"./isEqual.DXE01s-J.js";import"./index.Ct-vKfEQ.js";const _e=e({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:ne},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:a},activeActionIcon:{type:a},activeIcon:{type:a},inactiveIcon:{type:a},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:l(Function)},id:String,tabindex:{type:[String,Number]},label:{type:String,default:void 0},...ue(["ariaLabel"])}),ye={[me]:e=>t(e)||z(e)||i(e),[pe]:e=>t(e)||z(e)||i(e),[ve]:e=>t(e)||z(e)||i(e)},ke=["onClick"],he=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],Ve=["aria-hidden"],ge=["aria-hidden"],we=["aria-hidden"],xe="ElSwitch",je=A({name:xe});const Ie=p(m(A({...je,props:_e,emits:ye,setup(e,{expose:a,emit:l}){const i=e,{formItem:m}=fe(),p=s(),v=o("switch"),{inputId:f}=be(i,{formItemContext:m}),b=r(B((()=>i.loading))),_=N(!1!==i.modelValue),y=N(),k=N(),h=B((()=>[v.b(),v.m(p.value),v.is("disabled",b.value),v.is("checked",j.value)])),V=B((()=>[v.e("label"),v.em("label","left"),v.is("active",!j.value)])),g=B((()=>[v.e("label"),v.em("label","right"),v.is("active",j.value)])),w=B((()=>({width:n(i.width)})));P((()=>i.modelValue),(()=>{_.value=!0}));const x=B((()=>!!_.value&&i.modelValue)),j=B((()=>x.value===i.activeValue));[i.activeValue,i.inactiveValue].includes(x.value)||(l(me,i.inactiveValue),l(pe,i.inactiveValue),l(ve,i.inactiveValue)),P(j,(e=>{var a;y.value.checked=e,i.validateEvent&&(null==(a=null==m?void 0:m.validate)||a.call(m,"change").catch((e=>de())))}));const I=()=>{const e=j.value?i.inactiveValue:i.activeValue;l(me,e),l(pe,e),l(ve,e),Z((()=>{y.value.checked=j.value}))},C=()=>{if(b.value)return;const{beforeChange:e}=i;if(!e)return void I();const a=e();[ee(a),t(a)].includes(!0)||ce(xe,"beforeChange must return type `Promise<boolean>` or `boolean`"),ee(a)?a.then((e=>{e&&I()})).catch((e=>{})):a&&I()};return q((()=>{y.value.checked=j.value})),u({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-switch",ref:"https://element-plus.org/en-US/component/switch.html"},B((()=>!!i.label))),a({focus:()=>{var e,a;null==(a=null==(e=y.value)?void 0:e.focus)||a.call(e)},checked:j}),(e,a)=>($(),K("div",{class:L(F(h)),onClick:Y(C,["prevent"])},[R("input",{id:F(f),ref_key:"input",ref:y,class:L(F(v).e("input")),type:"checkbox",role:"switch","aria-checked":F(j),"aria-disabled":F(b),"aria-label":e.label||e.ariaLabel,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:F(b),tabindex:e.tabindex,onChange:I,onKeydown:O(C,["enter"])},null,42,he),e.inlinePrompt||!e.inactiveIcon&&!e.inactiveText?J("v-if",!0):($(),K("span",{key:0,class:L(F(V))},[e.inactiveIcon?($(),X(F(d),{key:0},{default:D((()=>[($(),X(H(e.inactiveIcon)))])),_:1})):J("v-if",!0),!e.inactiveIcon&&e.inactiveText?($(),K("span",{key:1,"aria-hidden":F(j)},M(e.inactiveText),9,Ve)):J("v-if",!0)],2)),R("span",{ref_key:"core",ref:k,class:L(F(v).e("core")),style:G(F(w))},[e.inlinePrompt?($(),K("div",{key:0,class:L(F(v).e("inner"))},[e.activeIcon||e.inactiveIcon?($(),X(F(d),{key:0,class:L(F(v).is("icon"))},{default:D((()=>[($(),X(H(F(j)?e.activeIcon:e.inactiveIcon)))])),_:1},8,["class"])):e.activeText||e.inactiveText?($(),K("span",{key:1,class:L(F(v).is("text")),"aria-hidden":!F(j)},M(F(j)?e.activeText:e.inactiveText),11,ge)):J("v-if",!0)],2)):J("v-if",!0),R("div",{class:L(F(v).e("action"))},[e.loading?($(),X(F(d),{key:0,class:L(F(v).is("loading"))},{default:D((()=>[Q(F(c))])),_:1},8,["class"])):F(j)?W(e.$slots,"active-action",{key:1},(()=>[e.activeActionIcon?($(),X(F(d),{key:0},{default:D((()=>[($(),X(H(e.activeActionIcon)))])),_:1})):J("v-if",!0)])):F(j)?J("v-if",!0):W(e.$slots,"inactive-action",{key:2},(()=>[e.inactiveActionIcon?($(),X(F(d),{key:0},{default:D((()=>[($(),X(H(e.inactiveActionIcon)))])),_:1})):J("v-if",!0)]))],2)],6),e.inlinePrompt||!e.activeIcon&&!e.activeText?J("v-if",!0):($(),K("span",{key:1,class:L(F(g))},[e.activeIcon?($(),X(F(d),{key:0},{default:D((()=>[($(),X(H(e.activeIcon)))])),_:1})):J("v-if",!0),!e.activeIcon&&e.activeText?($(),K("span",{key:1,"aria-hidden":!F(j)},M(e.activeText),9,we)):J("v-if",!0)],2))],10,ke))}}),[["__file","switch.vue"]])),Ce={class:"am-account-header"},Ue={class:"am-user-operator"},Ee={class:"am-table"},Se={class:"am-user-create"},Te={class:"am-user-create__operator"},ze={class:"am-user-create"},Ae={class:"am-user-create__operator"},Be=re(A({__name:"index",setup(e){q((()=>{i(),r()}));const a=N(0),l=N([]),t=N(!1),i=async()=>{t.value=!0;const{data:e}=await x();l.value=e.data,a.value+=1,t.value=!1},s=e=>"admin"===e.username,o=N([]),r=async()=>{const{data:e}=await j();o.value=e.data},n=N(!1),u=N(),d=N({username:"",password:"",remark:"",role_ids:[],status:"1"}),c=ae({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],role_ids:[{required:!0,message:"请选择角色",trigger:"blur"}]}),m=N(!1),p=N(!1),z=N(),A=N(!1),B=N({id:"",username:"",remark:"",role_ids:[],status:"1"}),P=N(!1);return(e,r)=>{const x=E,j=w,N=V,q=S,L=g,O=T,H=b,J=h,W=k,G=Ie,Y=y,Z=_,ee=f,ae=v;return $(),K(te,null,[R("div",Ce,[R("span",{onClick:r[0]||(r[0]=a=>e.$router.push("/account/user"))},"用户"),R("span",{onClick:r[1]||(r[1]=a=>e.$router.push("/account/role"))},"角色"),R("span",{onClick:r[2]||(r[2]=a=>e.$router.push("/account/api"))},"接口")]),R("div",Ue,[Q(j,{shadow:"never"},{default:D((()=>[Q(x,{type:"primary",plain:"",onClick:r[3]||(r[3]=e=>n.value=!0)},{default:D((()=>[ie("新增用户")])),_:1})])),_:1})]),Q(j,{shadow:"never"},{default:D((()=>[R("div",Ee,[se(($(),X(L,{data:F(l),height:"100%",key:F(a),stripe:"",ref:"multipleTable"},{default:D((()=>[Q(N,{prop:"username",label:"用户名","min-width":"120",align:"center"}),Q(N,{prop:"role",label:"角色","min-width":"160",align:"center"},{default:D((e=>[($(!0),K(te,null,oe(e.row.roles,((e,a)=>($(),X(q,{key:a},{default:D((()=>[ie(M(e.name),1)])),_:2},1024)))),128))])),_:1}),Q(N,{prop:"status",label:"状态","min-width":"100",align:"center",sortable:""},{default:D((e=>[1===e.row.status?($(),X(q,{key:0,type:"success"},{default:D((()=>[ie("正常")])),_:1})):($(),X(q,{key:1,type:"danger"},{default:D((()=>[ie("禁用")])),_:1}))])),_:1}),Q(N,{prop:"created_at",label:"创建时间","min-width":"160",align:"center",sortable:""}),Q(N,{label:"操作",width:"200",fixed:"right",align:"center"},{default:D((e=>[Q(x,{type:"primary",size:"small",text:"",onClick:a=>{return l=e.row,A.value=!0,void(B.value={id:l.id,username:l.username,remark:l.remark,role_ids:l.roles.map((e=>e.id)),status:l.status.toString()});var l},disabled:s(e.row)},{default:D((()=>[ie(" 编辑 ")])),_:2},1032,["onClick","disabled"]),se(($(),X(x,{type:"danger",size:"small",text:"",onClick:a=>(async e=>{p.value=!0,C({ids:[e]}).finally((()=>{p.value=!1,i()}))})(e.row.id),disabled:s(e.row)},{default:D((()=>[ie(" 删除 ")])),_:2},1032,["onClick","disabled"])),[[ae,F(p)]])])),_:1})])),_:1},8,["data"])),[[ae,F(t)]])])])),_:1}),R("div",Se,[Q(ee,{modelValue:F(n),"onUpdate:modelValue":r[11]||(r[11]=e=>le(n)?n.value=e:null),title:"创建用户",size:"50%"},{default:D((()=>[Q(Z,{ref_key:"userCreateRef",ref:u,model:F(d),rules:F(c),"label-width":"120px","label-position":"left"},{default:D((()=>[Q(H,{label:"用户名",prop:"username"},{default:D((()=>[Q(O,{modelValue:F(d).username,"onUpdate:modelValue":r[4]||(r[4]=e=>F(d).username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),Q(H,{label:"密码",prop:"password"},{default:D((()=>[Q(O,{modelValue:F(d).password,"onUpdate:modelValue":r[5]||(r[5]=e=>F(d).password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),Q(H,{label:"角色",prop:"role_ids"},{default:D((()=>[Q(W,{modelValue:F(d).role_ids,"onUpdate:modelValue":r[6]||(r[6]=e=>F(d).role_ids=e),multiple:"",placeholder:"请选择角色"},{default:D((()=>[($(!0),K(te,null,oe(F(o),(e=>($(),X(J,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),Q(H,{label:"备注",prop:"remark"},{default:D((()=>[Q(O,{modelValue:F(d).remark,"onUpdate:modelValue":r[7]||(r[7]=e=>F(d).remark=e),placeholder:"请输入备注"},null,8,["modelValue"])])),_:1}),Q(H,{label:"状态",prop:"status"},{default:D((()=>[Q(Y,{content:"用户状态，1为正常，2为禁用",placement:"top"},{default:D((()=>[Q(G,{modelValue:F(d).status,"onUpdate:modelValue":r[8]||(r[8]=e=>F(d).status=e),"active-value":"1","inactive-value":"2"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model","rules"]),R("div",Te,[Q(x,{type:"default",size:"default",plain:"",onClick:r[9]||(r[9]=e=>n.value=!1)},{default:D((()=>[ie("取消")])),_:1}),se(($(),X(x,{type:"primary",size:"default",plain:"",onClick:r[10]||(r[10]=e=>(async e=>{e&&await e.validate((e=>{if(e){m.value=!0;const e={username:d.value.username,password:d.value.password,remark:d.value.remark,role_ids:d.value.role_ids,status:Number(d.value.status)};I(e).finally((()=>{m.value=!1,n.value=!1,i()}))}}))})(F(u)))},{default:D((()=>[ie(" 确定 ")])),_:1})),[[ae,F(m)]])])])),_:1},8,["modelValue"])]),R("div",ze,[Q(ee,{modelValue:F(A),"onUpdate:modelValue":r[18]||(r[18]=e=>le(A)?A.value=e:null),title:"编辑用户",size:"50%"},{default:D((()=>[Q(Z,{ref_key:"userUpdateRef",ref:z,model:F(B),rules:F(c),"label-width":"120px","label-position":"left"},{default:D((()=>[Q(H,{label:"用户名",prop:"username"},{default:D((()=>[Q(O,{modelValue:F(B).username,"onUpdate:modelValue":r[12]||(r[12]=e=>F(B).username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),Q(H,{label:"角色",prop:"role_ids"},{default:D((()=>[Q(W,{modelValue:F(B).role_ids,"onUpdate:modelValue":r[13]||(r[13]=e=>F(B).role_ids=e),multiple:"",placeholder:"请选择角色"},{default:D((()=>[($(!0),K(te,null,oe(F(o),(e=>($(),X(J,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),Q(H,{label:"备注",prop:"remark"},{default:D((()=>[Q(O,{modelValue:F(B).remark,"onUpdate:modelValue":r[14]||(r[14]=e=>F(B).remark=e),placeholder:"请输入备注"},null,8,["modelValue"])])),_:1}),Q(H,{label:"状态",prop:"status"},{default:D((()=>[Q(Y,{content:"用户状态，1为正常，2为禁用",placement:"top"},{default:D((()=>[Q(G,{modelValue:F(B).status,"onUpdate:modelValue":r[15]||(r[15]=e=>F(B).status=e),"active-value":"1","inactive-value":"2"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model","rules"]),R("div",Ae,[Q(x,{type:"default",size:"default",plain:"",onClick:r[16]||(r[16]=e=>A.value=!1)},{default:D((()=>[ie("取消")])),_:1}),se(($(),X(x,{type:"primary",size:"default",plain:"",onClick:r[17]||(r[17]=e=>(async e=>{e&&await e.validate((e=>{if(e){P.value=!0;const e={id:B.value.id,username:B.value.username,remark:B.value.remark,role_ids:B.value.role_ids,status:Number(B.value.status)};U(e).finally((()=>{P.value=!1,A.value=!1,i()}))}}))})(F(z)))},{default:D((()=>[ie(" 确定 ")])),_:1})),[[ae,F(P)]])])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-258013f4"]]);export{Be as default};
