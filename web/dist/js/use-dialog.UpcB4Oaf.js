import{n as e,f as o,t as l,a8 as t,r as n,s as a,b as s,d as u,i as r,Z as c,a9 as d,aa as i,o as p,ab as f,c as y}from"./message.BD1JyyvK.js";import{Y as m,c as v,D as b,ae as g,a6 as C,d as x,m as k,j as B,L as M,r as w,P as S,o as h,M as I}from"./index.uDfNkopd.js";import{P as D}from"./vnode.Bk1o17iN.js";import{U as E}from"./index.CF_PnOnI.js";import{t as O,u as j}from"./use-form-item.Clb94WV_.js";import{g as z}from"./scroll.v84v66-f.js";import{i as A}from"./focus-trap.Y0jdQh1F.js";const F=(s,u={})=>{m(s)||O("[useLockscreen]","You need to pass a ref param to this function");const r=u.ns||e("popup"),c=v((()=>r.bm("parent","hidden")));if(!o||l(document.body,c.value))return;let d=0,i=!1,p="0";const f=()=>{setTimeout((()=>{a(null==document?void 0:document.body,c.value),i&&document&&(document.body.style.width=p)}),200)};b(s,(e=>{if(!e)return void f();i=!l(document.body,c.value),i&&(p=document.body.style.width),d=z(r.namespace.value);const o=document.documentElement.clientHeight<document.body.scrollHeight,a=t(document.body,"overflowY");d>0&&(o||"scroll"===a)&&i&&(document.body.style.width=`calc(100% - ${d}px)`),n(document.body,c.value)})),g((()=>f()))},L=e=>{if(!e)return{onClick:C,onMousedown:C,onMouseup:C};let o=!1,l=!1;return{onClick:t=>{o&&l&&e(t),o=l=!1},onMousedown:e=>{o=e.target===e.currentTarget},onMouseup:e=>{l=e.target===e.currentTarget}}},P=s({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:u([String,Array,Object])},zIndex:{type:u([String,Number])}});const T=x({name:"ElOverlay",props:P,emits:{click:e=>e instanceof MouseEvent},setup(o,{slots:l,emit:t}){const n=e("overlay"),{onClick:a,onMousedown:s,onMouseup:u}=L(o.customMaskEvent?void 0:e=>{t("click",e)});return()=>o.mask?k("div",{class:[n.b(),o.overlayClass],style:{zIndex:o.zIndex},onClick:a,onMousedown:s,onMouseup:u},[B(l,"default")],D.STYLE|D.CLASS|D.PROPS,["onClick","onMouseup","onMousedown"]):M("div",{class:o.overlayClass,style:{zIndex:o.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[B(l,"default")])}}),N=s({center:Boolean,alignCenter:Boolean,closeIcon:{type:r},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),Y={close:()=>!0},$=s({...N,appendToBody:Boolean,appendTo:{type:u(String),default:"body"},beforeClose:{type:u(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),R={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[E]:e=>c(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},V=(e,l)=>{var t;const n=I().emit,{nextZIndex:a}=d();let s="";const u=j(),r=j(),c=w(!1),m=w(!1),g=w(!1),C=w(null!=(t=e.zIndex)?t:a());let x,k;const B=i("namespace",f),M=v((()=>{const o={},l=`--${B.value}-dialog`;return e.fullscreen||(e.top&&(o[`${l}-margin-top`]=e.top),e.width&&(o[`${l}-width`]=p(e.width))),o})),D=v((()=>e.alignCenter?{display:"flex"}:{}));function O(){null==k||k(),null==x||x(),e.openDelay&&e.openDelay>0?({stop:x}=y((()=>P()),e.openDelay)):P()}function z(){null==x||x(),null==k||k(),e.closeDelay&&e.closeDelay>0?({stop:k}=y((()=>T()),e.closeDelay)):T()}function L(){e.beforeClose?e.beforeClose((function(e){e||(m.value=!0,c.value=!1)})):z()}function P(){o&&(c.value=!0)}function T(){c.value=!1}return e.lockScroll&&F(c),b((()=>e.modelValue),(o=>{o?(m.value=!1,O(),g.value=!0,C.value=A(e.zIndex)?a():C.value++,S((()=>{n("open"),l.value&&(l.value.scrollTop=0)}))):c.value&&z()})),b((()=>e.fullscreen),(e=>{l.value&&(e?(s=l.value.style.transform,l.value.style.transform=""):l.value.style.transform=s)})),h((()=>{e.modelValue&&(c.value=!0,g.value=!0,O())})),{afterEnter:function(){n("opened")},afterLeave:function(){n("closed"),n(E,!1),e.destroyOnClose&&(g.value=!1)},beforeLeave:function(){n("close")},handleClose:L,onModalClick:function(){e.closeOnClickModal&&L()},close:z,doClose:T,onOpenAutoFocus:function(){n("openAutoFocus")},onCloseAutoFocus:function(){n("closeAutoFocus")},onCloseRequested:function(){e.closeOnPressEscape&&L()},onFocusoutPrevented:function(e){var o;"pointer"===(null==(o=e.detail)?void 0:o.focusReason)&&e.preventDefault()},titleId:u,bodyId:r,closed:m,style:M,overlayDialogStyle:D,rendered:g,visible:c,zIndex:C}};export{T as E,L as a,Y as b,$ as c,N as d,R as e,V as f,F as u};
