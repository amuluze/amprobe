import"./el-button.BjoBO7gr.js";import{v as e}from"./el-loading.DfFQSHKu.js";import{E as a}from"./el-progress.BRV2ZJOd.js";import{_ as t}from"./index.BWKbS7n9.js";import{E as o}from"./el-dialog.CmjWSnXT.js";import{a as l,s as i}from"./message.CGCr1_ri.js";import{u as s,z as r,E as n,a as p}from"./zh-cn.Cbj5cIxv.js";/* empty css               */import"./el-select.6CKOSpid.js";import"./el-popper.DAgRe_4_.js";import{E as m,a as d}from"./el-table-column.By6jK7Ub.js";import"./el-tooltip.l0sNRNKZ.js";import{E as u}from"./el-card.L05dtrPJ.js";import{a as c,g,p as f,h}from"./index.cucq6WIU.js";import{d as j,y as v,o as _,r as w,k as C,f as k,m as y,w as b,u as x,X as z,F as E,a as V,A as B,e as U,b as $,R as A,S,_ as O}from"./index.uYlXueq8.js";import{E as T}from"./index.BfXoIbvI.js";import{E as q}from"./index.uJQQwVZH.js";import{E as D}from"./index.Bnc2yDHC.js";import"./index.DYXx8Gyw.js";import"./_baseClone.CcQ2SXwG.js";import"./_Uint8Array.BmwZGk8g.js";import"./_initCloneObject.CF8SazBh.js";import"./isEqual.AaDxTWef.js";import"./use-dialog.BQbW5qj8.js";import"./vnode.nPexdVgf.js";import"./event.BwRzfsZt.js";import"./use-form-item.BK24vgth.js";import"./scroll.D6lis9rj.js";import"./focus-trap.DFYIA1qy.js";import"./refs.D7nGhiLi.js";import"./index.AUD6zAb7.js";import"./token.DWNpOE8r.js";import"./castArray.8IR8Ymat.js";import"./index.CSTJ0c2Y.js";import"./aria.C-hsWcn7.js";import"./validator.CPx0XA2U.js";const I=e=>(A("data-v-d67fd53e"),e=e(),S(),e),K={class:"am-image-title"},L={class:"am-image-operator"},P={class:"am-table"},R={class:"am-pagination"},X={class:"am-image-pull"},F={class:"am-image-import"},G=I((()=>k("div",{class:"el-upload__text"},[B("Drop file here or "),k("em",null,"click to upload")],-1))),H=I((()=>k("div",{class:"el-upload__tip"},"tar/tar.gz files",-1))),M=O(j({__name:"index",setup(j){const A=v();_((()=>{I()}));const S=w(0),{data:O,refresh:I,loading:M,pagination:W}=s(c,{},{}),Y=()=>{f().then((()=>{l({type:"success",message:"清理完成"})}))},J=w(!1),N=w(!1),Q=w(""),Z=async()=>{J.value=!0;let e={image_name:Q.value};const{data:a}=await h(e);J.value=!1,N.value=!1,I()},ee=w(!1),ae=()=>{i("导入成功"),ee.value=!1,I()};return(i,s)=>{const c=q,f=u,h=m,j=d,v=n,_=p,w=D,te=o,oe=t,le=a,ie=e;return V(),C(E,null,[k("div",K,[k("span",{onClick:s[0]||(s[0]=e=>i.$router.push("/docker/container"))},"容器"),k("span",{onClick:s[1]||(s[1]=e=>i.$router.push("/docker/image"))},"镜像"),k("span",{onClick:s[2]||(s[2]=e=>i.$router.push("/docker/network"))},"网络"),k("span",{onClick:s[3]||(s[3]=e=>i.$router.push("/docker/settings"))},"设置")]),k("div",L,[y(f,{shadow:"never"},{default:b((()=>[y(c,{type:"primary",plain:"",onClick:s[4]||(s[4]=e=>N.value=!0)},{default:b((()=>[B("拉取镜像")])),_:1}),y(c,{type:"primary",plain:"",onClick:s[5]||(s[5]=e=>ee.value=!0)},{default:b((()=>[B("导入镜像")])),_:1}),y(c,{type:"warning",plain:"",onClick:Y},{default:b((()=>[B("清理虚悬镜像")])),_:1})])),_:1})]),y(f,{shadow:"never"},{default:b((()=>[k("div",P,[U((V(),$(j,{data:x(O),key:x(S),"highlight-current-row":"",height:"100%",stripe:""},{default:b((()=>[y(h,{prop:"name",label:"镜像名称",align:"center","min-width":"150","show-overflow-tooltip":"",fixed:"",sortable:""}),y(h,{prop:"number",label:"容器数量",align:"center","show-overflow-tooltip":"",width:"120",sortable:""}),y(h,{prop:"tag",label:"镜像 Tag",align:"center","show-overflow-tooltip":"",width:"120"}),y(h,{prop:"created",label:"创建时间",align:"center",width:"200",sortable:""}),y(h,{prop:"size",label:"镜像大小",align:"center",width:"120",sortable:""}),y(h,{label:"操作",width:"160",fixed:"right",align:"center"},{default:b((e=>[y(c,{type:"danger",plain:"",size:"small",onClick:a=>{return t=e.row.id,T.confirm("该操作会删除该镜像. 继续吗?","警告",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",beforeClose:(e,a,o)=>{"confirm"===e?(a.confirmButtonLoading=!0,g({image_id:t}).then((()=>{l({type:"success",message:"删除完成"})})).finally((()=>{a.confirmButtonLoading=!1,o(),I(),S.value+=1}))):o()}}).then((()=>{})).catch((()=>{l({type:"info",message:"删除取消"})})),void I();var t}},{default:b((()=>[B(" 删除 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ie,x(M)]])]),k("div",R,[y(_,{locale:x(r)},{default:b((()=>[y(v,{"current-page":x(W).page,"onUpdate:currentPage":s[6]||(s[6]=e=>x(W).page=e),"page-size":x(W).size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":x(W).sizeOption,total:x(W).total,onSizeChange:x(W).onSizeChange,onCurrentChange:x(W).onPageChange},null,8,["current-page","page-size","page-sizes","total","onSizeChange","onCurrentChange"])])),_:1},8,["locale"])])])),_:1}),k("div",X,[y(te,{modelValue:x(N),"onUpdate:modelValue":s[8]||(s[8]=e=>z(N)?N.value=e:null),title:"拉取镜像",width:"50%"},{default:b((()=>[y(w,{modelValue:x(Q),"onUpdate:modelValue":s[7]||(s[7]=e=>z(Q)?Q.value=e:null),placeholder:"请输入镜像名称"},null,8,["modelValue"]),U((V(),$(c,{size:"default",type:"info",plain:"",onClick:Z},{default:b((()=>[B(" 确定 ")])),_:1})),[[ie,x(J)]])])),_:1},8,["modelValue"])]),k("div",F,[y(te,{modelValue:x(ee),"onUpdate:modelValue":s[9]||(s[9]=e=>z(ee)?ee.value=e:null),title:"导入镜像",width:"50%"},{default:b((()=>[y(le,{drag:"",action:"/app/api/v1/container/image_import",headers:{Authorization:`Bearer ${x(A).user.token}`},limit:1,multiple:"","on-success":ae},{tip:b((()=>[H])),default:b((()=>[y(oe,{"icon-class":"upload"}),G])),_:1},8,["headers"])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-d67fd53e"]]);export{M as default};
