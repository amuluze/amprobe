var e=Object.defineProperty,a=(a,l,o)=>((a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o)(a,"symbol"!=typeof l?l+"":l,o);import{E as l,_ as o,u as t,w as s}from"./base.CwKrOXiL.js";import{u as r,z as n,E as i,a as d,b as c,c as p,v as u}from"./zh-cn.DYEbico1.js";import{d as f,a as m,b as v,c as g,u as h,E as w}from"./el-drawer.Cqqo91Vr.js";import{k as y,C as b,l as _}from"./el-overlay.CI2e2OO9.js";import{E as C,a as k}from"./el-card.w3-18o3J.js";import"./el-select.BLelAYUm.js";import"./el-popper.DMOJ8Ypx.js";import"./el-tooltip.l0sNRNKZ.js";import{c as j,E as x,a as z,b as E}from"./el-dropdown-item.BvhuhEbr.js";import{q as A,s as $,c as R,r as I,d as F}from"./index.Bgpk65Je.js";import{E as P}from"./index.PfrcTW0-.js";import{d as T,h as V,c as L,o as U,e as B,D as M,f as D,n as S,u as q,B as O,m as G,v as K,x as H,y as W,C as J,z as N,s as Q,r as X,p as Y,E as Z,P as ee,a5 as ae,G as le,I as oe,a6 as te,j as se,a1 as re,F as ne,A as ie,_ as de}from"./index.DR6loZJs.js";import{E as ce,u as pe}from"./index.mu6OJJAJ.js";import{F as ue,E as fe}from"./focus-trap.GHIWC1jm.js";import{u as me,E as ve}from"./index.C6eNzBMW.js";import{E as ge}from"./index.v0D0o9LE.js";import{E as he}from"./index.BNy-OgOy.js";import"./error.D_Dr4eZ1.js";import"./use-form-item.KseOUpWN.js";import"./_Uint8Array.ClTZMasr.js";import"./event.CWrEFZfq.js";import"./_initCloneObject.Blw69Ayb.js";import"./strings.Ck4ADK9s.js";import"./scroll.B2RFdPg8.js";import"./castArray.BhBSoVDq.js";import"./vnode.B-TQM2jz.js";import"./aria.C-hsWcn7.js";const we=Symbol("dialogInjectionKey"),ye=["aria-level"],be=["aria-label"],_e=["id"],Ce=T({name:"ElDialogContent"});var ke=o(T({...Ce,props:f,emits:m,setup(e){const a=e,{t:o}=y(),{Close:t}=b,{dialogRef:s,headerRef:r,bodyId:n,ns:i,style:d}=V(we),{focusTrapRef:c}=V(ue),p=L((()=>[i.b(),i.is("fullscreen",a.fullscreen),i.is("draggable",a.draggable),i.is("align-center",a.alignCenter),{[i.m("center")]:a.center}])),u=j(c,s),f=L((()=>a.draggable)),m=L((()=>a.overflow));return me(s,r,f,m),(e,a)=>(U(),B("div",{ref:q(u),class:S(q(p)),style:N(q(d)),tabindex:"-1"},[M("header",{ref_key:"headerRef",ref:r,class:S([q(i).e("header"),{"show-close":e.showClose}])},[D(e.$slots,"header",{},(()=>[M("span",{role:"heading","aria-level":e.ariaLevel,class:S(q(i).e("title"))},O(e.title),11,ye)])),e.showClose?(U(),B("button",{key:0,"aria-label":q(o)("el.dialog.close"),class:S(q(i).e("headerbtn")),type:"button",onClick:a[0]||(a[0]=a=>e.$emit("close"))},[G(q(l),{class:S(q(i).e("close"))},{default:K((()=>[(U(),H(W(e.closeIcon||q(t))))])),_:1},8,["class"])],10,be)):J("v-if",!0)],2),M("div",{id:q(n),class:S(q(i).e("body"))},[D(e.$slots,"default")],10,_e),e.$slots.footer?(U(),B("footer",{key:0,class:S(q(i).e("footer"))},[D(e.$slots,"footer")],2)):J("v-if",!0)],6))}}),[["__file","dialog-content.vue"]]);const je=["aria-label","aria-labelledby","aria-describedby"],xe=T({name:"ElDialog",inheritAttrs:!1});const ze=s(o(T({...xe,props:v,emits:g,setup(e,{expose:a}){const l=e,o=Q();_({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},L((()=>!!o.title)));const s=t("dialog"),r=X(),n=X(),i=X(),{visible:d,titleId:c,bodyId:p,style:u,overlayDialogStyle:f,rendered:m,zIndex:v,afterEnter:g,afterLeave:w,beforeLeave:y,handleClose:b,onModalClick:C,onOpenAutoFocus:k,onCloseAutoFocus:j,onCloseRequested:x,onFocusoutPrevented:z}=h(l,r);Y(we,{dialogRef:r,headerRef:n,bodyId:p,ns:s,rendered:m,style:u});const E=pe(C),A=L((()=>l.draggable&&!l.fullscreen));return a({visible:d,dialogContentRef:i}),(e,a)=>(U(),H(te,{to:e.appendTo,disabled:"body"===e.appendTo&&!e.appendToBody},[G(oe,{name:"dialog-fade",onAfterEnter:q(g),onAfterLeave:q(w),onBeforeLeave:q(y),persisted:""},{default:K((()=>[Z(G(q(ce),{"custom-mask-event":"",mask:e.modal,"overlay-class":e.modalClass,"z-index":q(v)},{default:K((()=>[M("div",{role:"dialog","aria-modal":"true","aria-label":e.title||void 0,"aria-labelledby":e.title?void 0:q(c),"aria-describedby":q(p),class:S(`${q(s).namespace.value}-overlay-dialog`),style:N(q(f)),onClick:a[0]||(a[0]=(...e)=>q(E).onClick&&q(E).onClick(...e)),onMousedown:a[1]||(a[1]=(...e)=>q(E).onMousedown&&q(E).onMousedown(...e)),onMouseup:a[2]||(a[2]=(...e)=>q(E).onMouseup&&q(E).onMouseup(...e))},[G(q(fe),{loop:"",trapped:q(d),"focus-start-el":"container",onFocusAfterTrapped:q(k),onFocusAfterReleased:q(j),onFocusoutPrevented:q(z),onReleaseRequested:q(x)},{default:K((()=>[q(m)?(U(),H(ke,ee({key:0,ref_key:"dialogContentRef",ref:i},e.$attrs,{center:e.center,"align-center":e.alignCenter,"close-icon":e.closeIcon,draggable:q(A),overflow:e.overflow,fullscreen:e.fullscreen,"show-close":e.showClose,title:e.title,"aria-level":e.headerAriaLevel,onClose:q(b)}),ae({header:K((()=>[e.$slots.title?D(e.$slots,"title",{key:1}):D(e.$slots,"header",{key:0,close:q(b),titleId:q(c),titleClass:q(s).e("title")})])),default:K((()=>[D(e.$slots,"default")])),_:2},[e.$slots.footer?{name:"footer",fn:K((()=>[D(e.$slots,"footer")]))}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):J("v-if",!0)])),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,je)])),_:3},8,["mask","overlay-class","z-index"]),[[le,q(d)]])])),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["to","disabled"]))}}),[["__file","dialog.vue"]]));class Ee{constructor(e,l=null,o=null,t=null,s=null){a(this,"url"),a(this,"ws"),a(this,"close"),a(this,"send");let r=window.location;e=r.host+"/"+e,this.url=/https/.test(r.protocol)?"wss://"+e:"ws://"+e,this.ws=new WebSocket(this.url),this.close=()=>{this.ws.close()},this.send=e=>{this.ws.send(e)},this.ws.onopen=e=>{null!==l&&l(this,e)},this.ws.onmessage=e=>{null!==o&&o(this,e)},this.ws.onerror=e=>{null!=t&&t(this,e)},this.ws.onclose=e=>{null!==s&&s(this,e)}}}const Ae={class:"am-container-title"},$e={class:"am-container-operator"},Re={class:"am-table"},Ie={class:"am-pagination"},Fe={class:"dialog-footer"},Pe={class:"am-container-create"},Te={class:"am-container-create__operator"},Ve=de(T({__name:"index",setup(e){se((()=>{o()}));const a={},{data:l,refresh:o,loading:t,pagination:s}=r(A,{},{}),f=X(!1),m=X(0),v=X("");let g;const h=()=>{f.value=!1,g.close()},y=()=>{g.close()},b=()=>{const e=document.createElement("a");e.setAttribute("href",`data:text/plain;charset=utf-8,${encodeURIComponent(v.value)}`),e.setAttribute("download","log.txt"),e.style.display="none",e.click()},_=X(!1);return(e,r)=>{const j=ge,A=C,T=i,V=k,L=x,D=z,S=E,W=d,J=c,N=p,Q=he,X=ze,Y=w,ee=u;return U(),B(ne,null,[M("div",Ae,[M("span",{onClick:r[0]||(r[0]=a=>e.$router.push("/docker/container"))},"容器"),M("span",{onClick:r[1]||(r[1]=a=>e.$router.push("/docker/image"))},"镜像"),M("span",{onClick:r[2]||(r[2]=a=>e.$router.push("/docker/network"))},"网络"),M("span",{onClick:r[3]||(r[3]=a=>e.$router.push("/docker/settings"))},"配置")]),M("div",$e,[G(A,{shadow:"never"},{default:K((()=>[G(j,{type:"primary",onClick:r[4]||(r[4]=e=>_.value=!0)},{default:K((()=>[ie("创建容器")])),_:1}),G(j,{type:"warning"},{default:K((()=>[ie("清理容器")])),_:1})])),_:1})]),G(A,{shadow:"never"},{default:K((()=>[M("div",Re,[Z((U(),H(W,{data:q(l),key:q(m),stripe:"",ref:"multipleTable"},{default:K((()=>[G(T,{prop:"id",label:"容器 ID","min-width":"100",align:"center",fixed:"",sortable:""}),G(T,{prop:"name",label:"容器名称",align:"center","min-width":"120","show-overflow-tooltip":"",fixed:"",sortable:""}),G(T,{prop:"image",label:"镜像名称",align:"center","min-width":"120","show-overflow-tooltip":"",sortable:""}),G(T,{prop:"ip",label:"容器 IP",align:"center","min-width":"100","show-overflow-tooltip":"",sortable:""}),G(T,{prop:"state",label:"运行状态",align:"center","min-width":"120","show-overflow-tooltip":""},{default:K((e=>[G(V,{type:"running"===e.row.state?"success":"danger"},{default:K((()=>[ie(O(e.row.state),1)])),_:2},1032,["type"])])),_:1}),G(T,{prop:"uptime",label:"启动时间",align:"center","min-width":"120","show-overflow-tooltip":"",sortable:""}),G(T,{prop:"cpu_percent",label:"CPU使用率",align:"center","min-width":"130","show-overflow-tooltip":"",sortable:""}),G(T,{prop:"memory_percent",label:"内存使用率",align:"center","min-width":"130","show-overflow-tooltip":"",sortable:""}),G(T,{prop:"memory_usage",label:"内存使用量",align:"center","min-width":"130","show-overflow-tooltip":"",sortable:""}),G(T,{prop:"memory_limit",label:"内存限制",align:"center","min-width":"120","show-overflow-tooltip":""}),G(T,{label:"操作",width:"200",fixed:"right",align:"center"},{default:K((e=>[G(j,{type:"primary",size:"small",text:"",onClick:a=>{return l=e.row.id,v.value="",f.value=!0,void(g=new Ee("ws/"+l,((e,a)=>{e.send(l)}),((e,a)=>{v.value=v.value+"\n"+a.data})));var l}},{default:K((()=>[ie(" 日志 ")])),_:2},1032,["onClick"]),G(j,{type:"primary",size:"small",text:"",onClick:a=>{return l=e.row.id,void $({container_id:l}).finally((()=>{o(),m.value+=1}));var l}},{default:K((()=>[ie(" 启动 ")])),_:2},1032,["onClick"]),G(S,null,{dropdown:K((()=>[G(D,null,{default:K((()=>[G(L,null,{default:K((()=>[G(j,{type:"warning",size:"small",text:"",onClick:a=>{return l=e.row.id,void R({container_id:l}).finally((()=>{o(),m.value+=1}));var l}},{default:K((()=>[ie(" 停止 ")])),_:2},1032,["onClick"])])),_:2},1024),G(L,null,{default:K((()=>[G(j,{type:"warning",size:"small",text:"",onClick:a=>{return l=e.row.id,void I({container_id:l}).finally((()=>{o(),m.value+=1}));var l}},{default:K((()=>[ie(" 重启 ")])),_:2},1032,["onClick"])])),_:2},1024),G(L,null,{default:K((()=>[G(j,{type:"danger",size:"small",text:"",onClick:a=>{return l=e.row.id,void ve.confirm("该操作会强制删除该容器. 继续吗?","警告",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((()=>{F({container_id:l}).then((()=>{P({type:"success",message:"删除完成"})})).finally((()=>{o(),m.value+=1}))})).catch((()=>{P({type:"info",message:"删除取消"})}));var l}},{default:K((()=>[ie(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),default:K((()=>[G(j,{type:"primary",size:"small",text:""},{default:K((()=>[ie("更多")])),_:1})])),_:2},1024)])),_:1})])),_:1},8,["data"])),[[ee,q(t)]])]),M("div",Ie,[G(N,{locale:q(n)},{default:K((()=>[G(J,{"current-page":q(s).page,"onUpdate:currentPage":r[5]||(r[5]=e=>q(s).page=e),"page-size":q(s).size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":q(s).sizeOption,total:q(s).total,onSizeChange:r[6]||(r[6]=e=>q(s).onSizeChange(e,a)),onCurrentChange:r[7]||(r[7]=e=>q(s).onPageChange(e,a))},null,8,["current-page","page-size","page-sizes","total"])])),_:1},8,["locale"])])])),_:1}),G(X,{modelValue:q(f),"onUpdate:modelValue":r[9]||(r[9]=e=>re(f)?f.value=e:null),title:"日志",width:"50%","before-close":h},{footer:K((()=>[M("div",Fe,[G(j,{size:"small",type:"primary",plain:"",onClick:b},{default:K((()=>[ie("下载")])),_:1}),G(j,{size:"small",type:"info",plain:"",onClick:y},{default:K((()=>[ie("停止")])),_:1}),G(j,{size:"small",type:"success",plain:"",onClick:h},{default:K((()=>[ie("关闭")])),_:1})])])),default:K((()=>[G(Q,{modelValue:q(v),"onUpdate:modelValue":r[8]||(r[8]=e=>re(v)?v.value=e:null),rows:"20",type:"textarea"},null,8,["modelValue"])])),_:1},8,["modelValue"]),M("div",Pe,[G(Y,{modelValue:q(_),"onUpdate:modelValue":r[10]||(r[10]=e=>re(_)?_.value=e:null),size:"540",title:"创建容器"},{default:K((()=>[M("div",Te,[G(j,{type:"default",size:"default",plain:""},{default:K((()=>[ie("取消")])),_:1}),G(j,{type:"primary",size:"default",plain:""},{default:K((()=>[ie("确定")])),_:1})])])),_:1},8,["modelValue"])])],64)}}}),[["__scopeId","data-v-f6473260"]]);export{Ve as default};
